var map,map2,mark,currentPosition="",latitulong="",user="",n=1,oldDate="",pos=1;function loadCurrentWeather(e){"use strict";try{oldDate=localStorage&&localStorage.ultimoaccesso?localStorage.ultimoaccesso:"MAI",localStorage.setItem("ultimoaccesso",moment().format("LL")+" "+moment().format("LTS")),localStorage&&localStorage.username?user=localStorage.username:(user="Mario",localStorage.username=user)}catch(e){console.log(e),user="Mario",oldDate="Non Disponibile"}finally{for(var t=["nome","accesso","icona","temp","wind","cloudiness","pressure","humidity","sunrise","sunset"],a=[user,oldDate,e.weather[0].icon,e.main.temp,e.wind,e.weather[0].description,e.main.pressure,e.main.humidity,e.sys.sunrise,e.sys.sunset],o=0;o<t.length;o++)load(t[o],a[o])}$(".loader").fadeOut()}function addRow(e){"use strict";var t=$(document.createElement("tr"));$(t).addClass("forecast");for(var a=1;a<e.length;a++)1===a?$(t).append('<th scope="row" id="'+e[a]+'" class="text-center"></th>'):"ficona"===e[a].slice(0,6)?$(t).append('<td class="text-center"><img id="'+e[a]+'"></img></td>'):$(t).append('<td id="'+e[a]+'" class="text-center"></td>');return t}function addRowTh(e){"use strict";var t=$(document.createElement("tr"));$(t).addClass("forecast bg-inverse text-white");for(var a=0;a<e.length;a++)$(t).append('<th id="'+e[a]+'" class="text-center"></th>');return t}function backForward(e){"use strict";e?pos<n&&($("#btBack").prop("disabled",!1),$(".num-"+pos).fadeOut(300,function(){$(".num-"+pos).fadeIn()}),$("#data"+pos).hide(),pos++,$("#data"+pos).show(),pos===n&&$("#btForward").prop("disabled",!0)):pos>1&&($("#btForward").prop("disabled",!1),$(".num-"+pos).fadeOut(300,function(){$(".num-"+pos).fadeIn()}),$("#data"+pos).hide(),pos--,$("#data"+pos).show(),1===pos&&$("#btBack").prop("disabled",!0))}function loadForecast(e){"use strict";var t,a;console.log(e),n=1,pos=1;var o={date:moment.unix(e.list[0].dt).format("L"),index:0};$("article").remove("#contForecast"),$("div").remove("#headForecast");var r=$(document.createElement("article"));$(r).attr("id","contForecast");var d=$(document.createElement("div"));for($(d).attr("id","headForecast"),$(d).addClass("modal-title col order-first"),$("#dateHeader").append(d),$("#contTable").append(r);o.index<39;){var i=$(document.createElement("h5"));$(i).attr("id","data"+n),$("#headForecast").append(i),$(i).hide(),load("data"+n,e.list[o.index].dt,n);var s=$(document.createElement("table"));$(s).addClass("num-"+n+" table table-hover"),$(r).append(s),$(s).hide();var l=["ora"+n,"fenomeno"+n,"tempo"+n,"temperatura"+n],c=["Ora","Fenomeno","Tempo","Temperatura"],m=$(document.createElement("thead"));$(s).append(m),$(m).append(addRowTh(l));for(var p=0;p<l.length;p++)load(l[p],c[p],o.index);for(n++,t=e.list[o.index];o.date===moment.unix(t.dt).format("L");)if(o.index<=39){o.date=moment.unix(t.dt).format("L"),t=e.list[o.index];var u=["data","time"+o.index,"ficona"+o.index,"fcloudiness"+o.index,"ftemp"+o.index],g=[t.dt,t.dt,t.weather[0].icon,t.weather[0].description,t.main.temp];a=addRow(u);var f=$(document.createElement("tbody"));for($(s).append(f),$(f).append(a),p=1;p<u.length;p++)load(u[p],g[p],o.index);o.index++}else t=e.list[o.index-1],o.date="";o.date=moment.unix(t.dt).format("L")}n--,$("#btBack").prop("disabled",!0),$("#btForward").prop("disabled",!1),$(".num-1").show(),$("#data1").show()}function findPosition(e){"use strict";var t;(new google.maps.Geocoder).geocode({address:e},function(e,a){"OK"===a?(t={center:e[0].geometry.location,zoom:10},map=new google.maps.Map(document.getElementById("mappa"),t),mark=new google.maps.Marker({position:t.center,map:map}),map2=new google.maps.Map(document.getElementById("mappa2"),t),mark=new google.maps.Marker({position:t.center,map:map2}),latitulong=t.center,document.getElementById("geoCoords").innerText=latitulong.lat().toFixed(2)+", "+latitulong.lng().toFixed(2),document.getElementById("luogo").innerText=e[0].formatted_address,$.getJSON("https://api.openweathermap.org/data/2.5/weather?lat="+latitulong.lat()+"&lon="+latitulong.lng()+"&lang=it&APPID=ee6b293d773f4fcd7e434f79bbc341f2",loadCurrentWeather),$.getJSON("https://api.openweathermap.org/data/2.5/forecast?lat="+latitulong.lat()+"&lon="+latitulong.lng()+"&lang=it&APPID=ee6b293d773f4fcd7e434f79bbc341f2",loadForecast)):(alert("Nessun Risultato"),$("#myModal").modal("show"))})}function loadPosition(){"use strict";navigator.geolocation?navigator.geolocation.getCurrentPosition(loadMap,noGeolocation):alert("non disponibile")}function noGeolocation(){"use strict";loadMap(),$(".loader").fadeOut(),enableMarker(),$("#myModal").modal()}function loadMap(e){"use strict";var t;if(e&&e.coords){var a=e.coords.latitude,o=e.coords.longitude;t={center:new google.maps.LatLng(a,o),zoom:10}}else t={center:new google.maps.LatLng(42.94,12.55),zoom:5};latitulong=t.center,document.getElementById("geoCoords").innerText=latitulong.lat().toFixed(2)+", "+latitulong.lng().toFixed(2),(new google.maps.Geocoder).geocode({location:t.center},function(e){e[0]?(currentPosition=e[0].formatted_address,document.getElementById("luogo").innerText=currentPosition):alert("No Result")}),map=new google.maps.Map(document.getElementById("mappa"),t),mark=new google.maps.Marker({position:t.center,map:map}),map2=new google.maps.Map(document.getElementById("mappa2"),t),mark=new google.maps.Marker({position:t.center,map:map2}),$.getJSON("https://api.openweathermap.org/data/2.5/weather?lat="+latitulong.lat()+"&lon="+latitulong.lng()+"&lang=it&APPID=ee6b293d773f4fcd7e434f79bbc341f2",loadCurrentWeather),$.getJSON("https://api.openweathermap.org/data/2.5/forecast?lat="+latitulong.lat()+"&lon="+latitulong.lng()+"&lang=it&APPID=ee6b293d773f4fcd7e434f79bbc341f2",loadForecast)}function load(e,t,a){"use strict";var o=document.getElementById(e);switch(e){case"icona":case"ficona"+a:o.src="https://openweathermap.org/img/w/"+t+".png";break;case"temp":case"ftemp"+a:var n=t-273.15;o.innerText=n.toFixed(1)+"Â°C";break;case"wind":void 0===t.deg?o.innerText="calmo":o.innerText=" "+t.speed+" m/s,  ("+t.deg+")";break;case"sunrise":case"sunset":case"time"+a:o.innerText=moment.unix(t).format("kk:mm");break;case"data"+a:o.innerText=moment.unix(t).format("LL");break;default:o.innerText=t}}function enableMarker(){"use strict";google.maps.event.addListener(map2,"click",function(e){(new google.maps.Geocoder).geocode({location:e.latLng},function(t){t[0]?(currentPosition=t[0].formatted_address,$("#srch-term").val(currentPosition),mark.setMap(null),mark=new google.maps.Marker({position:e.latLng,map:map2})):alert("No Result")})})}window.addEventListener("load",function(){"use strict";loadPosition()}),$("#btSearch").click(function(){"use strict";$("#myModal").modal("hide"),findPosition($("#srch-term").val())}),$("#modalSearch").on("keyup",function(e){"use strict";13===e.keyCode&&($("#myModal").modal("hide"),findPosition($("#srch-term").val()))}),$("#btForward").click(function(){"use strict";backForward(!0)}),$("#btBack").click(function(){"use strict";backForward(!1)}),$("#findPosition").click(function(){"use strict";enableMarker()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIm1hcCIsIm1hcDIiLCJtYXJrIiwiY3VycmVudFBvc2l0aW9uIiwibGF0aXR1bG9uZyIsInVzZXIiLCJuIiwib2xkRGF0ZSIsInBvcyIsImxvYWRDdXJyZW50V2VhdGhlciIsIndlYXRoZXIiLCJsb2NhbFN0b3JhZ2UiLCJ1bHRpbW9hY2Nlc3NvIiwic2V0SXRlbSIsIm1vbWVudCIsImZvcm1hdCIsInVzZXJuYW1lIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFycmF5SWQiLCJhcnJheVZhbHVlIiwiaWNvbiIsIm1haW4iLCJ0ZW1wIiwid2luZCIsImRlc2NyaXB0aW9uIiwicHJlc3N1cmUiLCJodW1pZGl0eSIsInN5cyIsInN1bnJpc2UiLCJzdW5zZXQiLCJpIiwibGVuZ3RoIiwibG9hZCIsIiQiLCJmYWRlT3V0IiwiYWRkUm93IiwiYXJyYXkiLCJ0ciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFkZENsYXNzIiwiYXBwZW5kIiwic2xpY2UiLCJhZGRSb3dUaCIsImJhY2tGb3J3YXJkIiwiZGlyZWN0aW9uIiwicHJvcCIsImZhZGVJbiIsImhpZGUiLCJzaG93IiwibG9hZEZvcmVjYXN0IiwiZm9yZWNhc3QiLCJvbGREYXkiLCJkYXRlIiwidW5peCIsImxpc3QiLCJkdCIsImluZGV4IiwicmVtb3ZlIiwiYXJ0aWNsZSIsImF0dHIiLCJoZWFkIiwiaDMiLCJ0YWJsZSIsImFycmF5VGgiLCJhcnJheVZhbHVlVGgiLCJ0aGVhZCIsInRib2R5IiwiZmluZFBvc2l0aW9uIiwicG9zaXRpb24iLCJtYXBQcm9wIiwiZ29vZ2xlIiwibWFwcyIsIkdlb2NvZGVyIiwiZ2VvY29kZSIsImFkZHJlc3MiLCJyZXN1bHRzIiwic3RhdHVzIiwiY2VudGVyIiwiZ2VvbWV0cnkiLCJsb2NhdGlvbiIsInpvb20iLCJNYXAiLCJnZXRFbGVtZW50QnlJZCIsIk1hcmtlciIsImlubmVyVGV4dCIsImxhdCIsInRvRml4ZWQiLCJsbmciLCJmb3JtYXR0ZWRfYWRkcmVzcyIsImdldEpTT04iLCJhbGVydCIsIm1vZGFsIiwibG9hZFBvc2l0aW9uIiwibmF2aWdhdG9yIiwiZ2VvbG9jYXRpb24iLCJnZXRDdXJyZW50UG9zaXRpb24iLCJsb2FkTWFwIiwibm9HZW9sb2NhdGlvbiIsImVuYWJsZU1hcmtlciIsImNvb3JkcyIsImxhdGl0dWRpbmUiLCJsYXRpdHVkZSIsImxvbmdpdHVkaW5lIiwibG9uZ2l0dWRlIiwiTGF0TG5nIiwiaWQiLCJ2YWx1ZSIsImoiLCJuYW1lIiwic3JjIiwidW5kZWZpbmVkIiwiZGVnIiwic3BlZWQiLCJldmVudCIsImFkZExpc3RlbmVyIiwibGF0TG5nIiwidmFsIiwic2V0TWFwIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsaWNrIiwib24iLCJlIiwia2V5Q29kZSJdLCJtYXBwaW5ncyI6IkFBR0EsSUFHQUEsSUFFQUMsS0FHQUMsS0FSQUMsZ0JBQUEsR0FDQUMsV0FBQSxHQUNBQyxLQUFBLEdBRUFDLEVBQUEsRUFFQUMsUUFBQSxHQUNBQyxJQUFBLEVBTUEsU0FBQUMsbUJBQUFDLEdBQ0EsYUFDQSxJQUVBSCxRQURBSSxjQUFBQSxhQUFBQyxjQUNBRCxhQUFBQyxjQUVBLE1BRUFELGFBQUFFLFFBQUEsZ0JBQUFDLFNBQUFDLE9BQUEsTUFBQSxJQUFBRCxTQUFBQyxPQUFBLFFBQ0FKLGNBQUFBLGFBQUFLLFNBQ0FYLEtBQUFNLGFBQUFLLFVBRUFYLEtBQUEsUUFDQU0sYUFBQUssU0FBQVgsTUFHQSxNQUFBWSxHQUNBQyxRQUFBQyxJQUFBRixHQUNBWixLQUFBLFFBQ0FFLFFBQUEsa0JBRUEsUUFHQSxJQUZBLElBQUFhLEdBQUEsT0FBQSxVQUFBLFFBQUEsT0FBQSxPQUFBLGFBQUEsV0FBQSxXQUFBLFVBQUEsVUFDQUMsR0FBQWhCLEtBQUFFLFFBQUFHLEVBQUFBLFFBQUEsR0FBQVksS0FBQVosRUFBQWEsS0FBQUMsS0FBQWQsRUFBQWUsS0FBQWYsRUFBQUEsUUFBQSxHQUFBZ0IsWUFBQWhCLEVBQUFhLEtBQUFJLFNBQUFqQixFQUFBYSxLQUFBSyxTQUFBbEIsRUFBQW1CLElBQUFDLFFBQUFwQixFQUFBbUIsSUFBQUUsUUFDQUMsRUFBQSxFQUFBQSxFQUFBWixFQUFBYSxPQUFBRCxJQUNBRSxLQUFBZCxFQUFBWSxHQUFBWCxFQUFBVyxJQUdBRyxFQUFBLFdBQUFDLFVBRUEsU0FBQUMsT0FBQUMsR0FDQSxhQUNBLElBQUFDLEVBQUFKLEVBQUFLLFNBQUFDLGNBQUEsT0FDQU4sRUFBQUksR0FBQUcsU0FBQSxZQUNBLElBQUEsSUFBQVYsRUFBQSxFQUFBQSxFQUFBTSxFQUFBTCxPQUFBRCxJQUNBLElBQUFBLEVBQ0FHLEVBQUFJLEdBQUFJLE9BQUEsdUJBQUFMLEVBQUFOLEdBQUEsK0JBR0EsV0FBQU0sRUFBQU4sR0FBQVksTUFBQSxFQUFBLEdBQ0FULEVBQUFJLEdBQUFJLE9BQUEsb0NBQUFMLEVBQUFOLEdBQUEsaUJBRUFHLEVBQUFJLEdBQUFJLE9BQUEsV0FBQUwsRUFBQU4sR0FBQSwrQkFJQSxPQUFBTyxFQUVBLFNBQUFNLFNBQUFQLEdBQ0EsYUFDQSxJQUFBQyxFQUFBSixFQUFBSyxTQUFBQyxjQUFBLE9BQ0FOLEVBQUFJLEdBQUFHLFNBQUEsa0NBQ0EsSUFBQSxJQUFBVixFQUFBLEVBQUFBLEVBQUFNLEVBQUFMLE9BQUFELElBQ0FHLEVBQUFJLEdBQUFJLE9BQUEsV0FBQUwsRUFBQU4sR0FBQSwrQkFFQSxPQUFBTyxFQUVBLFNBQUFPLFlBQUFDLEdBQ0EsYUFDQUEsRUFDQXZDLElBQUFGLElBQ0E2QixFQUFBLFdBQUFhLEtBQUEsWUFBQSxHQUNBYixFQUFBLFFBQUEzQixLQUFBNEIsUUFBQSxJQUFBLFdBQ0FELEVBQUEsUUFBQTNCLEtBQUF5QyxXQUVBZCxFQUFBLFFBQUEzQixLQUFBMEMsT0FDQTFDLE1BQ0EyQixFQUFBLFFBQUEzQixLQUFBMkMsT0FDQTNDLE1BQUFGLEdBQ0E2QixFQUFBLGNBQUFhLEtBQUEsWUFBQSxJQUtBeEMsSUFBQSxJQUNBMkIsRUFBQSxjQUFBYSxLQUFBLFlBQUEsR0FDQWIsRUFBQSxRQUFBM0IsS0FBQTRCLFFBQUEsSUFBQSxXQUNBRCxFQUFBLFFBQUEzQixLQUFBeUMsV0FFQWQsRUFBQSxRQUFBM0IsS0FBQTBDLE9BQ0ExQyxNQUVBMkIsRUFBQSxRQUFBM0IsS0FBQTJDLE9BQ0EsSUFBQTNDLEtBQ0EyQixFQUFBLFdBQUFhLEtBQUEsWUFBQSxJQUtBLFNBQUFJLGFBQUFDLEdBQ0EsYUFFQSxJQUFBM0MsRUFHQTZCLEVBSkFyQixRQUFBQyxJQUFBa0MsR0FFQS9DLEVBQUEsRUFDQUUsSUFBQSxFQUVBLElBQUE4QyxHQUNBQyxLQUFBekMsT0FBQTBDLEtBQUFILEVBQUFJLEtBQUEsR0FBQUMsSUFBQTNDLE9BQUEsS0FDQTRDLE1BQUEsR0FFQXhCLEVBQUEsV0FBQXlCLE9BQUEsaUJBQ0F6QixFQUFBLE9BQUF5QixPQUFBLGlCQUNBLElBQUFDLEVBQUExQixFQUFBSyxTQUFBQyxjQUFBLFlBQ0FOLEVBQUEwQixHQUFBQyxLQUFBLEtBQUEsZ0JBQ0EsSUFBQUMsRUFBQTVCLEVBQUFLLFNBQUFDLGNBQUEsUUFLQSxJQUpBTixFQUFBNEIsR0FBQUQsS0FBQSxLQUFBLGdCQUNBM0IsRUFBQTRCLEdBQUFyQixTQUFBLCtCQUNBUCxFQUFBLGVBQUFRLE9BQUFvQixHQUNBNUIsRUFBQSxjQUFBUSxPQUFBa0IsR0FDQVAsRUFBQUssTUFBQSxJQUFBLENBQ0EsSUFBQUssRUFBQTdCLEVBQUFLLFNBQUFDLGNBQUEsT0FDQU4sRUFBQTZCLEdBQUFGLEtBQUEsS0FBQSxPQUFBeEQsR0FDQTZCLEVBQUEsaUJBQUFRLE9BQUFxQixHQUNBN0IsRUFBQTZCLEdBQUFkLE9BQ0FoQixLQUFBLE9BQUE1QixFQUFBK0MsRUFBQUksS0FBQUgsRUFBQUssT0FBQUQsR0FBQXBELEdBQ0EsSUFBQTJELEVBQUE5QixFQUFBSyxTQUFBQyxjQUFBLFVBQ0FOLEVBQUE4QixHQUFBdkIsU0FBQSxPQUFBcEMsRUFBQSxzQkFDQTZCLEVBQUEwQixHQUFBbEIsT0FBQXNCLEdBQ0E5QixFQUFBOEIsR0FBQWYsT0FDQSxJQUFBZ0IsR0FBQSxNQUFBNUQsRUFBQSxXQUFBQSxFQUFBLFFBQUFBLEVBQUEsY0FBQUEsR0FDQTZELEdBQUEsTUFBQSxXQUFBLFFBQUEsZUFDQUMsRUFBQWpDLEVBQUFLLFNBQUFDLGNBQUEsVUFDQU4sRUFBQThCLEdBQUF0QixPQUFBeUIsR0FDQWpDLEVBQUFpQyxHQUFBekIsT0FBQUUsU0FBQXFCLElBQ0EsSUFBQSxJQUFBbEMsRUFBQSxFQUFBQSxFQUFBa0MsRUFBQWpDLE9BQUFELElBQ0FFLEtBQUFnQyxFQUFBbEMsR0FBQW1DLEVBQUFuQyxHQUFBc0IsRUFBQUssT0FJQSxJQUZBckQsSUFDQUksRUFBQTJDLEVBQUFJLEtBQUFILEVBQUFLLE9BQ0FMLEVBQUFDLE9BQUF6QyxPQUFBMEMsS0FBQTlDLEVBQUFnRCxJQUFBM0MsT0FBQSxNQUNBLEdBQUF1QyxFQUFBSyxPQUFBLEdBQUEsQ0FDQUwsRUFBQUMsS0FBQXpDLE9BQUEwQyxLQUFBOUMsRUFBQWdELElBQUEzQyxPQUFBLEtBQ0FMLEVBQUEyQyxFQUFBSSxLQUFBSCxFQUFBSyxPQUNBLElBQUF2QyxHQUFBLE9BQUEsT0FBQWtDLEVBQUFLLE1BQUEsU0FBQUwsRUFBQUssTUFBQSxjQUFBTCxFQUFBSyxNQUFBLFFBQUFMLEVBQUFLLE9BQ0F0QyxHQUFBWCxFQUFBZ0QsR0FBQWhELEVBQUFnRCxHQUFBaEQsRUFBQUEsUUFBQSxHQUFBWSxLQUFBWixFQUFBQSxRQUFBLEdBQUFnQixZQUFBaEIsRUFBQWEsS0FBQUMsTUFDQWUsRUFBQUYsT0FBQWpCLEdBQ0EsSUFBQWlELEVBQUFsQyxFQUFBSyxTQUFBQyxjQUFBLFVBR0EsSUFGQU4sRUFBQThCLEdBQUF0QixPQUFBMEIsR0FDQWxDLEVBQUFrQyxHQUFBMUIsT0FBQUosR0FDQVAsRUFBQSxFQUFBQSxFQUFBWixFQUFBYSxPQUFBRCxJQUNBRSxLQUFBZCxFQUFBWSxHQUFBWCxFQUFBVyxHQUFBc0IsRUFBQUssT0FFQUwsRUFBQUssYUFHQWpELEVBQUEyQyxFQUFBSSxLQUFBSCxFQUFBSyxNQUFBLEdBQ0FMLEVBQUFDLEtBQUEsR0FHQUQsRUFBQUMsS0FBQXpDLE9BQUEwQyxLQUFBOUMsRUFBQWdELElBQUEzQyxPQUFBLEtBRUFULElBQ0E2QixFQUFBLFdBQUFhLEtBQUEsWUFBQSxHQUNBYixFQUFBLGNBQUFhLEtBQUEsWUFBQSxHQUNBYixFQUFBLFVBQUFnQixPQUNBaEIsRUFBQSxVQUFBZ0IsT0FFQSxTQUFBbUIsYUFBQUMsR0FDQSxhQUNBLElBQUFDLEdBQ0EsSUFBQUMsT0FBQUMsS0FBQUMsVUFDQUMsU0FBQUMsUUFBQU4sR0FBQSxTQUFBTyxFQUFBQyxHQUNBLE9BQUFBLEdBQ0FQLEdBQ0FRLE9BQUFGLEVBQUEsR0FBQUcsU0FBQUMsU0FDQUMsS0FBQSxJQUVBbkYsSUFBQSxJQUFBeUUsT0FBQUMsS0FBQVUsSUFBQTVDLFNBQUE2QyxlQUFBLFNBQUFiLEdBQ0F0RSxLQUFBLElBQUF1RSxPQUFBQyxLQUFBWSxRQUNBZixTQUFBQyxFQUFBUSxPQUNBaEYsSUFBQUEsTUFFQUMsS0FBQSxJQUFBd0UsT0FBQUMsS0FBQVUsSUFBQTVDLFNBQUE2QyxlQUFBLFVBQUFiLEdBQ0F0RSxLQUFBLElBQUF1RSxPQUFBQyxLQUFBWSxRQUNBZixTQUFBQyxFQUFBUSxPQUNBaEYsSUFBQUMsT0FFQUcsV0FBQW9FLEVBQUFRLE9BQ0F4QyxTQUFBNkMsZUFBQSxhQUNBRSxVQUFBbkYsV0FBQW9GLE1BQUFDLFFBQUEsR0FBQSxLQUFBckYsV0FBQXNGLE1BQUFELFFBQUEsR0FDQWpELFNBQUE2QyxlQUFBLFNBQ0FFLFVBQUFULEVBQUEsR0FBQWEsa0JBQ0F4RCxFQUFBeUQsUUFBQSx1REFBQXhGLFdBQUFvRixNQUFBLFFBQUFwRixXQUFBc0YsTUFBQSxrREFBQWpGLG9CQUNBMEIsRUFBQXlELFFBQUEsd0RBQUF4RixXQUFBb0YsTUFBQSxRQUFBcEYsV0FBQXNGLE1BQUEsa0RBQUF0QyxnQkFFQXlDLE1BQUEsb0JBQ0ExRCxFQUFBLFlBQUEyRCxNQUFBLFdBSUEsU0FBQUMsZUFDQSxhQUNBQyxVQUFBQyxZQUNBRCxVQUFBQyxZQUFBQyxtQkFBQUMsUUFBQUMsZUFFQVAsTUFBQSxtQkFHQSxTQUFBTyxnQkFDQSxhQUNBRCxVQUNBaEUsRUFBQSxXQUFBQyxVQUNBaUUsZUFDQWxFLEVBQUEsWUFBQTJELFFBRUEsU0FBQUssUUFBQTVCLEdBQ0EsYUFDQSxJQUFBQyxFQUNBLEdBQUFELEdBQUFBLEVBQUErQixPQUFBLENBQ0EsSUFBQUMsRUFBQWhDLEVBQUErQixPQUFBRSxTQUNBQyxFQUFBbEMsRUFBQStCLE9BQUFJLFVBQ0FsQyxHQUNBUSxPQUFBLElBQUFQLE9BQUFDLEtBQUFpQyxPQUFBSixFQUFBRSxHQUNBdEIsS0FBQSxTQUdBWCxHQUNBUSxPQUFBLElBQUFQLE9BQUFDLEtBQUFpQyxPQUFBLE1BQUEsT0FDQXhCLEtBQUEsR0FHQS9FLFdBQUFvRSxFQUFBUSxPQUNBeEMsU0FBQTZDLGVBQUEsYUFDQUUsVUFBQW5GLFdBQUFvRixNQUFBQyxRQUFBLEdBQUEsS0FBQXJGLFdBQUFzRixNQUFBRCxRQUFBLElBQ0EsSUFBQWhCLE9BQUFDLEtBQUFDLFVBQ0FDLFNBQUFNLFNBQUFWLEVBQUFRLFFBQUEsU0FBQUYsR0FDQUEsRUFBQSxJQUNBM0UsZ0JBQUEyRSxFQUFBLEdBQUFhLGtCQUNBbkQsU0FBQTZDLGVBQUEsU0FDQUUsVUFBQXBGLGlCQUVBMEYsTUFBQSxlQUdBN0YsSUFBQSxJQUFBeUUsT0FBQUMsS0FBQVUsSUFBQTVDLFNBQUE2QyxlQUFBLFNBQUFiLEdBQ0F0RSxLQUFBLElBQUF1RSxPQUFBQyxLQUFBWSxRQUNBZixTQUFBQyxFQUFBUSxPQUNBaEYsSUFBQUEsTUFFQUMsS0FBQSxJQUFBd0UsT0FBQUMsS0FBQVUsSUFBQTVDLFNBQUE2QyxlQUFBLFVBQUFiLEdBQ0F0RSxLQUFBLElBQUF1RSxPQUFBQyxLQUFBWSxRQUNBZixTQUFBQyxFQUFBUSxPQUNBaEYsSUFBQUMsT0FFQWtDLEVBQUF5RCxRQUFBLHVEQUFBeEYsV0FBQW9GLE1BQUEsUUFBQXBGLFdBQUFzRixNQUFBLGtEQUFBakYsb0JBQ0EwQixFQUFBeUQsUUFBQSx3REFBQXhGLFdBQUFvRixNQUFBLFFBQUFwRixXQUFBc0YsTUFBQSxrREFBQXRDLGNBSUEsU0FBQWxCLEtBQUEwRSxFQUFBQyxFQUFBQyxHQUNBLGFBQ0EsSUFBQUMsRUFBQXZFLFNBQUE2QyxlQUFBdUIsR0FDQSxPQUFBQSxHQUNBLElBQUEsUUFBQSxJQUFBLFNBQUFFLEVBQ0FDLEVBQUFDLElBQUEsb0NBQUFILEVBQUEsT0FDQSxNQUNBLElBQUEsT0FBQSxJQUFBLFFBQUFDLEVBQ0EsSUFBQXRGLEVBQUFxRixFQUFBLE9BQ0FFLEVBQUF4QixVQUFBL0QsRUFBQWlFLFFBQUEsR0FBQSxLQUNBLE1BQ0EsSUFBQSxZQUNBd0IsSUFBQUosRUFBQUssSUFDQUgsRUFBQXhCLFVBQUEsUUFFQXdCLEVBQUF4QixVQUFBLElBQUFzQixFQUFBTSxNQUFBLFdBQUFOLEVBQUFLLElBQUEsSUFFQSxNQUNBLElBQUEsVUFBQSxJQUFBLFNBQUEsSUFBQSxPQUFBSixFQUNBQyxFQUFBeEIsVUFBQXpFLE9BQUEwQyxLQUFBcUQsR0FBQTlGLE9BQUEsU0FDQSxNQUNBLElBQUEsT0FBQStGLEVBQ0FDLEVBQUF4QixVQUFBekUsT0FBQTBDLEtBQUFxRCxHQUFBOUYsT0FBQSxNQUNBLE1BQ0EsUUFDQWdHLEVBQUF4QixVQUFBc0IsR0F1QkEsU0FBQVIsZUFDQSxhQUNBNUIsT0FBQUMsS0FBQTBDLE1BQUFDLFlBQUFwSCxLQUFBLFFBQUEsU0FBQW1ILElBQ0EsSUFBQTNDLE9BQUFDLEtBQUFDLFVBQ0FDLFNBQUFNLFNBQUFrQyxFQUFBRSxRQUFBLFNBQUF4QyxHQUNBQSxFQUFBLElBQ0EzRSxnQkFBQTJFLEVBQUEsR0FBQWEsa0JBQ0F4RCxFQUFBLGNBQUFvRixJQUFBcEgsaUJBQ0FELEtBQUFzSCxPQUFBLE1BQ0F0SCxLQUFBLElBQUF1RSxPQUFBQyxLQUFBWSxRQUNBZixTQUFBNkMsRUFBQUUsT0FDQXRILElBQUFDLFFBR0E0RixNQUFBLGlCQTNUQTRCLE9BQUFDLGlCQUFBLE9BQUEsV0FDQSxhQUNBM0IsaUJBdVJBNUQsRUFBQSxhQUFBd0YsTUFBQSxXQUNBLGFBQ0F4RixFQUFBLFlBQUEyRCxNQUFBLFFBQ0F4QixhQUFBbkMsRUFBQSxjQUFBb0YsU0FFQXBGLEVBQUEsZ0JBQUF5RixHQUFBLFFBQUEsU0FBQUMsR0FDQSxhQUNBLEtBQUFBLEVBQUFDLFVBQ0EzRixFQUFBLFlBQUEyRCxNQUFBLFFBQ0F4QixhQUFBbkMsRUFBQSxjQUFBb0YsVUFHQXBGLEVBQUEsY0FBQXdGLE1BQUEsV0FDQSxhQUNBN0UsYUFBQSxLQUVBWCxFQUFBLFdBQUF3RixNQUFBLFdBQ0EsYUFDQTdFLGFBQUEsS0FxQkFYLEVBQUEsaUJBQUF3RixNQUFBLFdBQ0EsYUFDQXRCIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qZ2xvYmFsIGdvb2dsZSAqL1xuLypnbG9iYWwgbW9tZW50ICovXG4vKmdsb2JhbCAkICovXG52YXIgY3VycmVudFBvc2l0aW9uID0gJyc7XG52YXIgbGF0aXR1bG9uZyA9ICcnO1xudmFyIHVzZXIgPSAnJztcbnZhciBtYXA7XG52YXIgbiA9IDE7XG52YXIgbWFwMjtcbnZhciBvbGREYXRlID0gJyc7XG52YXIgcG9zID0gMTtcbnZhciBtYXJrO1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGxvYWRQb3NpdGlvbigpO1xufSk7XG5mdW5jdGlvbiBsb2FkQ3VycmVudFdlYXRoZXIod2VhdGhlcikge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB0cnkge1xuICAgICAgICBpZiAobG9jYWxTdG9yYWdlICYmIGxvY2FsU3RvcmFnZS51bHRpbW9hY2Nlc3NvKSB7XG4gICAgICAgICAgICBvbGREYXRlID0gbG9jYWxTdG9yYWdlLnVsdGltb2FjY2Vzc287XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvbGREYXRlID0gXCJNQUlcIjtcbiAgICAgICAgfVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndWx0aW1vYWNjZXNzbycsIG1vbWVudCgpLmZvcm1hdCgnTEwnKSArICcgJyArIG1vbWVudCgpLmZvcm1hdCgnTFRTJykpO1xuICAgICAgICBpZiAobG9jYWxTdG9yYWdlICYmIGxvY2FsU3RvcmFnZS51c2VybmFtZSkge1xuICAgICAgICAgICAgdXNlciA9IGxvY2FsU3RvcmFnZS51c2VybmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHVzZXIgPSAnTWFyaW8nO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnVzZXJuYW1lID0gdXNlcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIHVzZXIgPSAnTWFyaW8nO1xuICAgICAgICBvbGREYXRlID0gXCJOb24gRGlzcG9uaWJpbGVcIjtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHZhciBhcnJheUlkID0gWydub21lJywgJ2FjY2Vzc28nLCAnaWNvbmEnLCAndGVtcCcsICd3aW5kJywgJ2Nsb3VkaW5lc3MnLCAncHJlc3N1cmUnLCAnaHVtaWRpdHknLCAnc3VucmlzZScsICdzdW5zZXQnXTtcbiAgICAgICAgdmFyIGFycmF5VmFsdWUgPSBbdXNlciwgb2xkRGF0ZSwgd2VhdGhlci53ZWF0aGVyWzBdLmljb24sIHdlYXRoZXIubWFpbi50ZW1wLCB3ZWF0aGVyLndpbmQsIHdlYXRoZXIud2VhdGhlclswXS5kZXNjcmlwdGlvbiwgd2VhdGhlci5tYWluLnByZXNzdXJlLCB3ZWF0aGVyLm1haW4uaHVtaWRpdHksIHdlYXRoZXIuc3lzLnN1bnJpc2UsIHdlYXRoZXIuc3lzLnN1bnNldF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlJZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbG9hZChhcnJheUlkW2ldLCBhcnJheVZhbHVlW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAkKCcubG9hZGVyJykuZmFkZU91dCgpO1xufVxuZnVuY3Rpb24gYWRkUm93KGFycmF5KSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciB0ciA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKSk7XG4gICAgJCh0cikuYWRkQ2xhc3MoJ2ZvcmVjYXN0Jyk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaSA9PT0gMSkge1xuICAgICAgICAgICAgJCh0cikuYXBwZW5kKCc8dGggc2NvcGU9XCJyb3dcIiBpZD1cIicgKyBhcnJheVtpXSArICdcIiBjbGFzcz1cInRleHQtY2VudGVyXCI+PC90aD4nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChhcnJheVtpXS5zbGljZSgwLCA2KSA9PT0gJ2ZpY29uYScpIHtcbiAgICAgICAgICAgICAgICAkKHRyKS5hcHBlbmQoJzx0ZCBjbGFzcz1cInRleHQtY2VudGVyXCI+PGltZyBpZD1cIicgKyBhcnJheVtpXSArICdcIj48L2ltZz48L3RkPicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKHRyKS5hcHBlbmQoJzx0ZCBpZD1cIicgKyBhcnJheVtpXSArICdcIiBjbGFzcz1cInRleHQtY2VudGVyXCI+PC90ZD4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHI7XG59XG5mdW5jdGlvbiBhZGRSb3dUaChhcnJheSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgdHIgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJykpO1xuICAgICQodHIpLmFkZENsYXNzKCdmb3JlY2FzdCBiZy1pbnZlcnNlIHRleHQtd2hpdGUnKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICQodHIpLmFwcGVuZCgnPHRoIGlkPVwiJyArIGFycmF5W2ldICsgJ1wiIGNsYXNzPVwidGV4dC1jZW50ZXJcIj48L3RoPicpO1xuICAgIH1cbiAgICByZXR1cm4gdHI7XG59XG5mdW5jdGlvbiBiYWNrRm9yd2FyZChkaXJlY3Rpb24pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKGRpcmVjdGlvbikge1xuICAgICAgICBpZiAocG9zIDwgbikge1xuICAgICAgICAgICAgJCgnI2J0QmFjaycpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgJCgnLm51bS0nICsgcG9zKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoJy5udW0tJyArIHBvcykuZmFkZUluKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoJyNkYXRhJyArIHBvcykuaGlkZSgpO1xuICAgICAgICAgICAgcG9zKys7XG4gICAgICAgICAgICAkKCcjZGF0YScgKyBwb3MpLnNob3coKTtcbiAgICAgICAgICAgIGlmKHBvcz09PW4pe1xuICAgICAgICAgICAgICAgICQoJyNidEZvcndhcmQnKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAocG9zID4gMSkge1xuICAgICAgICAgICAgJCgnI2J0Rm9yd2FyZCcpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgJCgnLm51bS0nICsgcG9zKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoJy5udW0tJyArIHBvcykuZmFkZUluKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICQoJyNkYXRhJyArIHBvcykuaGlkZSgpO1xuICAgICAgICAgICAgcG9zLS07XG4gICAgICAgICAgICAvLyAkKCcubnVtLScgKyBwb3MpLnNob3coKTtcbiAgICAgICAgICAgICQoJyNkYXRhJyArIHBvcykuc2hvdygpO1xuICAgICAgICAgICAgaWYocG9zPT09MSl7XG4gICAgICAgICAgICAgICAgJCgnI2J0QmFjaycpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBsb2FkRm9yZWNhc3QoZm9yZWNhc3QpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgY29uc29sZS5sb2coZm9yZWNhc3QpO1xuICAgIHZhciB3ZWF0aGVyO1xuICAgIG49MTtcbiAgICBwb3M9MTtcbiAgICB2YXIgdHI7XG4gICAgdmFyIG9sZERheSA9IHtcbiAgICAgICAgZGF0ZTogbW9tZW50LnVuaXgoZm9yZWNhc3QubGlzdFswXS5kdCkuZm9ybWF0KCdMJyksXG4gICAgICAgIGluZGV4OiAwLFxuICAgIH07XG4gICAgJCgnYXJ0aWNsZScpLnJlbW92ZSgnI2NvbnRGb3JlY2FzdCcpO1xuICAgICQoJ2RpdicpLnJlbW92ZSgnI2hlYWRGb3JlY2FzdCcpO1xuICAgIHZhciBhcnRpY2xlID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhcnRpY2xlJykpO1xuICAgICQoYXJ0aWNsZSkuYXR0cignaWQnLCAnY29udEZvcmVjYXN0Jyk7XG4gICAgdmFyIGhlYWQ9JChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSk7XG4gICAgJChoZWFkKS5hdHRyKCdpZCcsICdoZWFkRm9yZWNhc3QnKTtcbiAgICAkKGhlYWQpLmFkZENsYXNzKCdtb2RhbC10aXRsZSBjb2wgb3JkZXItZmlyc3QnKTtcbiAgICAkKCcjZGF0ZUhlYWRlcicpLmFwcGVuZChoZWFkKTtcbiAgICAkKCcjY29udFRhYmxlJykuYXBwZW5kKGFydGljbGUpO1xuICAgIHdoaWxlIChvbGREYXkuaW5kZXggPCAzOSkge1xuICAgICAgICB2YXIgaDMgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2g1JykpO1xuICAgICAgICAkKGgzKS5hdHRyKCdpZCcsICdkYXRhJyArIG4pO1xuICAgICAgICAkKCcjaGVhZEZvcmVjYXN0JykuYXBwZW5kKGgzKTtcbiAgICAgICAgJChoMykuaGlkZSgpO1xuICAgICAgICBsb2FkKCdkYXRhJyArIG4sIGZvcmVjYXN0Lmxpc3Rbb2xkRGF5LmluZGV4XS5kdCwgbik7XG4gICAgICAgIHZhciB0YWJsZSA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKSk7XG4gICAgICAgICQodGFibGUpLmFkZENsYXNzKCdudW0tJyArIG4gKyAnIHRhYmxlIHRhYmxlLWhvdmVyJyk7XG4gICAgICAgICQoYXJ0aWNsZSkuYXBwZW5kKHRhYmxlKTtcbiAgICAgICAgJCh0YWJsZSkuaGlkZSgpO1xuICAgICAgICB2YXIgYXJyYXlUaCA9IFsnb3JhJyArIG4sICdmZW5vbWVubycgKyBuLCAndGVtcG8nICsgbiwgJ3RlbXBlcmF0dXJhJyArIG5dO1xuICAgICAgICB2YXIgYXJyYXlWYWx1ZVRoID0gWydPcmEnLCAnRmVub21lbm8nLCAnVGVtcG8nLCAnVGVtcGVyYXR1cmEnXTtcbiAgICAgICAgdmFyIHRoZWFkID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aGVhZCcpKTtcbiAgICAgICAgJCh0YWJsZSkuYXBwZW5kKHRoZWFkKTtcbiAgICAgICAgJCh0aGVhZCkuYXBwZW5kKGFkZFJvd1RoKGFycmF5VGgpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheVRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsb2FkKGFycmF5VGhbaV0sIGFycmF5VmFsdWVUaFtpXSwgb2xkRGF5LmluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBuKys7XG4gICAgICAgIHdlYXRoZXIgPSBmb3JlY2FzdC5saXN0W29sZERheS5pbmRleF07XG4gICAgICAgIHdoaWxlIChvbGREYXkuZGF0ZSA9PT0gbW9tZW50LnVuaXgod2VhdGhlci5kdCkuZm9ybWF0KCdMJykpIHtcbiAgICAgICAgICAgIGlmIChvbGREYXkuaW5kZXggPD0gMzkpIHtcbiAgICAgICAgICAgICAgICBvbGREYXkuZGF0ZSA9IG1vbWVudC51bml4KHdlYXRoZXIuZHQpLmZvcm1hdCgnTCcpO1xuICAgICAgICAgICAgICAgIHdlYXRoZXIgPSBmb3JlY2FzdC5saXN0W29sZERheS5pbmRleF07XG4gICAgICAgICAgICAgICAgdmFyIGFycmF5SWQgPSBbJ2RhdGEnLCAndGltZScgKyBvbGREYXkuaW5kZXgsICdmaWNvbmEnICsgb2xkRGF5LmluZGV4LCAnZmNsb3VkaW5lc3MnICsgb2xkRGF5LmluZGV4LCAnZnRlbXAnICsgb2xkRGF5LmluZGV4XTtcbiAgICAgICAgICAgICAgICB2YXIgYXJyYXlWYWx1ZSA9IFt3ZWF0aGVyLmR0LCB3ZWF0aGVyLmR0LCB3ZWF0aGVyLndlYXRoZXJbMF0uaWNvbiwgd2VhdGhlci53ZWF0aGVyWzBdLmRlc2NyaXB0aW9uLCB3ZWF0aGVyLm1haW4udGVtcF07XG4gICAgICAgICAgICAgICAgdHIgPSBhZGRSb3coYXJyYXlJZCk7XG4gICAgICAgICAgICAgICAgdmFyIHRib2R5ID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpKTtcbiAgICAgICAgICAgICAgICAkKHRhYmxlKS5hcHBlbmQodGJvZHkpO1xuICAgICAgICAgICAgICAgICQodGJvZHkpLmFwcGVuZCh0cik7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IGFycmF5SWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZChhcnJheUlkW2ldLCBhcnJheVZhbHVlW2ldLCBvbGREYXkuaW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvbGREYXkuaW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdlYXRoZXIgPSBmb3JlY2FzdC5saXN0W29sZERheS5pbmRleC0xXTtcbiAgICAgICAgICAgICAgICBvbGREYXkuZGF0ZSA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG9sZERheS5kYXRlID0gbW9tZW50LnVuaXgod2VhdGhlci5kdCkuZm9ybWF0KCdMJyk7XG4gICAgfVxuICAgIG4tLTtcbiAgICAkKCcjYnRCYWNrJykucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAkKCcjYnRGb3J3YXJkJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgJCgnLm51bS0xJykuc2hvdygpO1xuICAgICQoJyNkYXRhMScpLnNob3coKTtcbn1cbmZ1bmN0aW9uIGZpbmRQb3NpdGlvbihwb3NpdGlvbikge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgbWFwUHJvcDtcbiAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgICBnZW9jb2Rlci5nZW9jb2RlKHsgJ2FkZHJlc3MnOiBwb3NpdGlvbiB9LCBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdPSycpIHtcbiAgICAgICAgICAgIG1hcFByb3AgPSB7XG4gICAgICAgICAgICAgICAgY2VudGVyOiByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLFxuICAgICAgICAgICAgICAgIHpvb206IDEwLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBwYVwiKSwgbWFwUHJvcCk7XG4gICAgICAgICAgICBtYXJrID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IG1hcFByb3AuY2VudGVyLFxuICAgICAgICAgICAgICAgIG1hcDogbWFwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1hcDIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwcGEyXCIpLCBtYXBQcm9wKTtcbiAgICAgICAgICAgIG1hcmsgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogbWFwUHJvcC5jZW50ZXIsXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxhdGl0dWxvbmcgPSBtYXBQcm9wLmNlbnRlcjtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dlb0Nvb3JkcycpO1xuICAgICAgICAgICAgbmFtZS5pbm5lclRleHQgPSBsYXRpdHVsb25nLmxhdCgpLnRvRml4ZWQoMikgKyAnLCAnICsgbGF0aXR1bG9uZy5sbmcoKS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgdmFyIGx1b2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2x1b2dvJyk7XG4gICAgICAgICAgICBsdW9nby5pbm5lclRleHQgPSByZXN1bHRzWzBdLmZvcm1hdHRlZF9hZGRyZXNzO1xuICAgICAgICAgICAgJC5nZXRKU09OKCdodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvd2VhdGhlcj9sYXQ9JyArIGxhdGl0dWxvbmcubGF0KCkgKyAnJmxvbj0nICsgbGF0aXR1bG9uZy5sbmcoKSArICcmbGFuZz1pdCZBUFBJRD1lZTZiMjkzZDc3M2Y0ZmNkN2U0MzRmNzliYmMzNDFmMicsIGxvYWRDdXJyZW50V2VhdGhlcik7XG4gICAgICAgICAgICAkLmdldEpTT04oJ2h0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9mb3JlY2FzdD9sYXQ9JyArIGxhdGl0dWxvbmcubGF0KCkgKyAnJmxvbj0nICsgbGF0aXR1bG9uZy5sbmcoKSArICcmbGFuZz1pdCZBUFBJRD1lZTZiMjkzZDc3M2Y0ZmNkN2U0MzRmNzliYmMzNDFmMicsIGxvYWRGb3JlY2FzdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhbGVydCgnTmVzc3VuIFJpc3VsdGF0bycpO1xuICAgICAgICAgICAgJCgnI215TW9kYWwnKS5tb2RhbCgnc2hvdycpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5mdW5jdGlvbiBsb2FkUG9zaXRpb24oKSB7IC8vZ2VvbG9jYWxpenphIGUgcmVzdGl0dWlzY2UgbCdpbmRpcml6em8gdXRpbGl6emFuZG8gaWwgcmV2ZXJzZSBnZW9jb2RpbmdcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKG5hdmlnYXRvci5nZW9sb2NhdGlvbikge1xuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGxvYWRNYXAsIG5vR2VvbG9jYXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFsZXJ0KCdub24gZGlzcG9uaWJpbGUnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBub0dlb2xvY2F0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBsb2FkTWFwKCk7XG4gICAgJCgnLmxvYWRlcicpLmZhZGVPdXQoKTtcbiAgICBlbmFibGVNYXJrZXIoKTtcbiAgICAkKFwiI215TW9kYWxcIikubW9kYWwoKTtcbn1cbmZ1bmN0aW9uIGxvYWRNYXAocG9zaXRpb24pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIG1hcFByb3A7XG4gICAgaWYgKHBvc2l0aW9uICYmIHBvc2l0aW9uLmNvb3Jkcykge1xuICAgICAgICB2YXIgbGF0aXR1ZGluZSA9IHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZTtcbiAgICAgICAgdmFyIGxvbmdpdHVkaW5lID0gcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZTtcbiAgICAgICAgbWFwUHJvcCA9IHtcbiAgICAgICAgICAgIGNlbnRlcjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXRpdHVkaW5lLCBsb25naXR1ZGluZSksXG4gICAgICAgICAgICB6b29tOiAxMCxcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBtYXBQcm9wID0ge1xuICAgICAgICAgICAgY2VudGVyOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDQyLjk0LCAxMi41NSksXG4gICAgICAgICAgICB6b29tOiA1LFxuICAgICAgICB9O1xuICAgIH1cbiAgICBsYXRpdHVsb25nID0gbWFwUHJvcC5jZW50ZXI7XG4gICAgdmFyIG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2VvQ29vcmRzJyk7XG4gICAgbmFtZS5pbm5lclRleHQgPSBsYXRpdHVsb25nLmxhdCgpLnRvRml4ZWQoMikgKyAnLCAnICsgbGF0aXR1bG9uZy5sbmcoKS50b0ZpeGVkKDIpO1xuICAgIHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuICAgIGdlb2NvZGVyLmdlb2NvZGUoeyAnbG9jYXRpb24nOiBtYXBQcm9wLmNlbnRlciB9LCBmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICBpZiAocmVzdWx0c1swXSkge1xuICAgICAgICAgICAgY3VycmVudFBvc2l0aW9uID0gcmVzdWx0c1swXS5mb3JtYXR0ZWRfYWRkcmVzcztcbiAgICAgICAgICAgIHZhciBsdW9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsdW9nbycpO1xuICAgICAgICAgICAgbHVvZ28uaW5uZXJUZXh0ID0gY3VycmVudFBvc2l0aW9uO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWxlcnQoJ05vIFJlc3VsdCcpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcHBhXCIpLCBtYXBQcm9wKTtcbiAgICBtYXJrID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgIHBvc2l0aW9uOiBtYXBQcm9wLmNlbnRlcixcbiAgICAgICAgbWFwOiBtYXBcbiAgICB9KTtcbiAgICBtYXAyID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcHBhMlwiKSwgbWFwUHJvcCk7XG4gICAgbWFyayA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICBwb3NpdGlvbjogbWFwUHJvcC5jZW50ZXIsXG4gICAgICAgIG1hcDogbWFwMlxuICAgIH0pO1xuICAgICQuZ2V0SlNPTignaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L3dlYXRoZXI/bGF0PScgKyBsYXRpdHVsb25nLmxhdCgpICsgJyZsb249JyArIGxhdGl0dWxvbmcubG5nKCkgKyAnJmxhbmc9aXQmQVBQSUQ9ZWU2YjI5M2Q3NzNmNGZjZDdlNDM0Zjc5YmJjMzQxZjInLCBsb2FkQ3VycmVudFdlYXRoZXIpO1xuICAgICQuZ2V0SlNPTignaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L2ZvcmVjYXN0P2xhdD0nICsgbGF0aXR1bG9uZy5sYXQoKSArICcmbG9uPScgKyBsYXRpdHVsb25nLmxuZygpICsgJyZsYW5nPWl0JkFQUElEPWVlNmIyOTNkNzczZjRmY2Q3ZTQzNGY3OWJiYzM0MWYyJywgbG9hZEZvcmVjYXN0KTtcblxuXG59XG5mdW5jdGlvbiBsb2FkKGlkLCB2YWx1ZSwgaikge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICBzd2l0Y2ggKGlkKSB7XG4gICAgICAgIGNhc2UgJ2ljb25hJzogY2FzZSAnZmljb25hJyArIGo6XG4gICAgICAgICAgICBuYW1lLnNyYyA9ICdodHRwczovL29wZW53ZWF0aGVybWFwLm9yZy9pbWcvdy8nICsgdmFsdWUgKyAnLnBuZyc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndGVtcCc6IGNhc2UgJ2Z0ZW1wJyArIGo6XG4gICAgICAgICAgICB2YXIgdGVtcCA9IHZhbHVlIC0gMjczLjE1O1xuICAgICAgICAgICAgbmFtZS5pbm5lclRleHQgPSB0ZW1wLnRvRml4ZWQoMSkgKyAnwrBDJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd3aW5kJzpcbiAgICAgICAgICAgIGlmICh2YWx1ZS5kZWcgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG5hbWUuaW5uZXJUZXh0ID0gJ2NhbG1vJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmFtZS5pbm5lclRleHQgPSAnICcgKyB2YWx1ZS5zcGVlZCArICcgbS9zLCAgKCcgKyB2YWx1ZS5kZWcgKyAnKSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc3VucmlzZSc6IGNhc2UgJ3N1bnNldCc6IGNhc2UgJ3RpbWUnICsgajpcbiAgICAgICAgICAgIG5hbWUuaW5uZXJUZXh0ID0gbW9tZW50LnVuaXgodmFsdWUpLmZvcm1hdCgna2s6bW0nKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkYXRhJyArIGo6XG4gICAgICAgICAgICBuYW1lLmlubmVyVGV4dCA9IG1vbWVudC51bml4KHZhbHVlKS5mb3JtYXQoJ0xMJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIG5hbWUuaW5uZXJUZXh0ID0gdmFsdWU7XG4gICAgfVxufVxuJCgnI2J0U2VhcmNoJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICAkKCcjbXlNb2RhbCcpLm1vZGFsKCdoaWRlJyk7XG4gICAgZmluZFBvc2l0aW9uKCQoJyNzcmNoLXRlcm0nKS52YWwoKSk7XG59KTtcbiQoXCIjbW9kYWxTZWFyY2hcIikub24oJ2tleXVwJywgZnVuY3Rpb24gKGUpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgJCgnI215TW9kYWwnKS5tb2RhbCgnaGlkZScpO1xuICAgICAgICBmaW5kUG9zaXRpb24oJCgnI3NyY2gtdGVybScpLnZhbCgpKTtcbiAgICB9XG59KTtcbiQoJyNidEZvcndhcmQnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGJhY2tGb3J3YXJkKHRydWUpO1xufSk7XG4kKCcjYnRCYWNrJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBiYWNrRm9yd2FyZChmYWxzZSk7XG59KTtcbmZ1bmN0aW9uIGVuYWJsZU1hcmtlcigpe1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAyLCAnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XG4gICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoeyAnbG9jYXRpb24nOiBldmVudC5sYXRMbmcgfSwgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHRzWzBdKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFBvc2l0aW9uID0gcmVzdWx0c1swXS5mb3JtYXR0ZWRfYWRkcmVzcztcbiAgICAgICAgICAgICAgICAkKCcjc3JjaC10ZXJtJykudmFsKGN1cnJlbnRQb3NpdGlvbik7Ly9kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3JjaC10ZXJtJyk7XG4gICAgICAgICAgICAgICAgbWFyay5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICAgICAgbWFyayA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogZXZlbnQubGF0TG5nLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcDJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ05vIFJlc3VsdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiQoJyNmaW5kUG9zaXRpb24nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGVuYWJsZU1hcmtlcigpO1xufSk7Il19
